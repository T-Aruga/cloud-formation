## クラウド設計の “11" のベストプラクティス
AWSではAWS Well-Architectedフレームワークが存在します。
これはAWSが今までの経験をもとにクラウドアーキテクチャ設計・運用の考え方とベストプラクティス集です。
この中で５つの設計原則と11のベストプラクティスが提唱されています。

1. スケーラビリティを確保する（信頼性、パフォーマンス効率）
2. 環境を自動化する（信頼性、運用の優秀性）
3. 使い捨て可能なリソースを 使用する（パフォーマンス効率）
4. コンポーネントを疎結合にする（信頼性）
5. サーバーではなくサービスで 設計する（パフォーマンス効率）
6. 適切なデータベースソリューション を選択する（パフォーマンス効率）
7. 単一障害点を排除する（信頼性）
8. コストを最適化する（コスト最適化）
9. キャッシュを使用する（パフォーマンス効率）
10. すべてのレイヤーでセキュリティを 確保する（安全性）
11. 増加するデータの管理（パフォーマンス効率）


## VPC環境の構成について
今回作成したVPC環境は、3層構造かつ3アベイラビリティゾーン構成です。
セキュリティと可用性を考慮した構成ではありますが、特性を理解して利用する必要があります。

## 3層構造について
まず、3層構造について確認します。
今回作成した3層は パブリックネットワーク と プラベートネットワーク(NATあり)、 プライベートネットワーク(NATなし) になります。

## パブリックサブネット
インターネットに対し、インバウンドとアウトバウンドの通信ができるサブネットです。
例えば、ElasticLoadBalancer(ELB)やパブリックIPを必要とするEC2インスタンス、NATゲートウェイなどを配置するために利用します。
インバウンド通信を必要としない場合は利用しないネットワークと考えておいてください。

## プライベートサブネット(NATあり)
インターネットに対し、アウトバウンドの通信ができるサブネットです。
例えば、パブリックIPが不要なEC2やECSなどで利用します。
ELBをフロントに持つEC2やECSの場合は直接アクセスする必要がないためここに配置するべきです。
アウトバウンドを行えるようにしておく理由は、「外部サービスとの連携」であったり「OSやミドルウェアのアップデート」を行うためなどが挙げられます。

## プライベートサブネット(NATなし)
インターネットに対し、インバウンドとアウトバウンドの通信ができないサブネットです。
例えば、RDSやインターナルのELBなどを配置します。
内部通信しか行えないため、外に出してはいけない情報などを扱うのに適しています。

以下、AWSリソース配置例です。

ただし、システムの状況に応じて配置場所は変わる場合ばあります。

## 3アベイラビリティゾーン構成について
アベイラビリティゾーン(AZ)はデータセンターのことです。複数AZを用意するということは物理的に独立したデータセンターを用意することになります。
システムを構築する際はAZ障害が発生した際のリスク回避としてAZを分散させるようにAWSリソースを配置しましょう。
ですが分散させるのは冗長構成が取れているものに限ります。
仮にEC2とRDSが1台ずつしか存在しない場合、AZを分散させてしまうと障害リスクが倍になってしまうからです。
まずは1つのAZでシステムを完結させた上で、他のAZへスケールアウトさせるといった考え方が良いです。

以下は一般的なWebサービスの構成です。
①の「M」はRDSをMulti-AZにした際のマスターで、②と③の「S」はスレーブを示しています。



①の部分を作成した後、耐障害性を考えて②を作成します。
この構成であれば、もし①のAZで障害が発生しても②へフェイルオーバーするため、サービスの継続が可能です。
さらにWebを追加する場合は③に追加します。RDSがマルチAZで、かつサブネットグループが3つのAZで作られているのであれば、どのAZで障害が発生しても残り2つのAZで冗長構成を維持できます。
